# CAS无锁

CAS原理：

CAS原语有三个参数，内存地址，期望值，新值。如果内存地址的值==期望值，表示该值未修改，此时可以修改成新值。否则表示修改失败，返回false，由用户决定后续操作。

缺点：

使用CAS会造成ABA问题


ABA 问题

thread1意图对val=1进行操作变成2，cas(*val,1,2)。

thread1先读取val=1；thread1被抢占，让thread2运行。

thread2 修改val=3，又修改回1。

thread1继续执行，发现期望值与“原值”（其实被修改过了）相同，完成CAS操作。

解决方案

ABAʹ：添加额外的标记用来指示是否被修改。
