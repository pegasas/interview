# linux磁盘管理

Linux磁盘管理
一、设备类型：

（1）块设备：block ，存取单位“块”，磁盘

　　字符设备：char ，存取单位“字符”，键盘



 （2）机械硬盘和固态硬盘

机械硬盘（HDD ）：即是传统普通硬盘，主要由：盘片，磁头，盘片转轴及控制电机，磁头控制器，数据转换器，接口，缓存等几个部分组成。机械硬盘中所有的盘片都装在一个旋转轴上，每张盘片

之间是平行的，在每个盘片的存储面上有一个磁头，磁头与盘片之间的距离比头发丝的直径还小，所有的磁头联在一个磁头控制器上，由磁头控制器负责各个磁头的运动。磁头可沿盘片的半径方向运动，加上盘片每分钟几千转的高速旋转，磁头就可以定位在盘片的指定位置上进行数据的读写操作。数据通过磁头由电磁流来改变极性方式被电磁流写到磁盘上，也可以通过相反方式读取。硬盘为精密设备，进入硬盘的空气必须过滤。

固态硬盘（SSD ）：用固态电子存储芯片阵列而制成的硬盘，由控制单元和存储单元（FLASH 芯片、DRAM 芯片）组成。固态硬盘在接口的规范和定义、功能及使用方法上与普通硬盘的完全相同，

在产品外形和尺寸上也与普通硬盘一致。

比较：

相较于HDD ，SSD 在防震抗摔、传输速率、功耗、重量、噪音上有明显优势，SSD 传输速率性能是HDD 的2倍

相较于SSD ，HDD 在价格、容量、使用寿命上占有绝对优势

硬盘有价，数据无价，目前SSD 不能完全取代HHD



（3）设备文件

① 磁盘设备的设备文件命名：/dev/DEV_FILE

② 不同磁盘标识：a-z,aa,ab…

/dev/sda, /dev/sdb, ... /dev/sdaa,/dev/sdab...

同一设备上的不同分区：1,2, ...

/dev/sda1, /dev/sda5

③ 硬盘存储术语

　　head ：磁头

　　track ：磁道

　　cylinder:  柱面

　　secotr:  扇区，512bytes（最小单位）

 ④ HDD磁盘结构

CHS

512bytes    *   64 sector数/track    *    1024  track数/盘面       256   head磁头数（盘面数）   8G

  扇区                 扇区数/磁道                       磁道/盘面

( 512bytes    *   64 sector数/track    *   256 )一个柱面的大小：8M  * 1024磁道 =8G

单位：B KB MB GB TB PB EB ZB YB BB NB DB



（4）如何使用分区空间？（后边会详细讲解每一步）

① 设备识别

② 设备分区

③ 文件系统类型格式化

④ 在/etc/fstab 文件中创建条目

⑤ mount 挂载新的文件系统



（5）为什么分区？

① 优化I/O 性能

② 实现磁盘空间配额限制

③ 提高修复速度

④ 隔离系统和程序

⑤ 安装多个OS

⑥ 采用不同文件系统



（6）两种寻址方法：CHS和LBA

 CHS：

　　采用24bit 位寻址

　　其中前10 位表示cylinder ，中间8 位表示head ，后面6 位表示sector。 。

　　最大寻址空间8GB

LBA （logical block addressing）：

　　LBA 是一个整数，通过转换成CHS 格式完成磁盘具体寻址

　　LBA 采用48 个bit 位寻址

　　最大寻址空间128PB

由于CHS 寻址方式的寻址空间在大概8GB 以内，所以在磁盘容量小于大概8GB 时，可以使用CHS 寻址方式或是LBA 寻址方式；在磁盘容量大于大概8GB 时，则只能使用LBA 寻址方式



二、分区介绍

两种分区方式：MBR ，GPT

（1）MBR: Master Boot Record ，1982年， 使用32位表示扇区数 ， 分区不超过2T

如何分区：按柱面

　　0 磁道0 扇区：512bytes

　　446bytes: boot loader

　　64bytes ：分区表

　　　　16bytes:  标识一个分区

　　2bytes: 55AA，结束标志

4 个主分区；3 主分区+1 扩展(N 个逻辑分区)



分区表（DPT）结构




（2）硬盘主引导记录MBR 主要由 3 个部分组成

① 主引导程序（偏移地址0000H--0088H ），它负责从活动分区中装载，并运行系统引导程序。

出错信息数据区，偏移地址0089H--00E1H 为出错信息，00E2H--01BDH 全为0 字节。

② 分区表（DPT,Disk Partition Table ）含4 个分区项，偏移地址01BEH--01FDH, 每个分区表项长16 个字节，共64 字节为

分区项1 、分区项2 、分区项3 、分区项4

③ 结束标志字，偏移地址01FE--01FF 的2 个字节值为结束标志 55AA





（3）GPT分区

① GPT:GUID （Globals Unique Identifiers） partitiontable  支持128个分区，使用64 位，支持8Z（512Byte/block ）64Z （4096Byte/block）

使用128 位UUID(Universally Unique Identifier)  表示磁盘区 和分区 GPT 分区表自动备份在头和尾两份，并有CRC 校验位

UEFI ( 统一扩展固件接口) 硬件支持GPT ，使操作系统启动

② EFI部分又可以分为4个区域：EFI信息区(GPT头)、分区表、GPT分区、备份区域

 
